
```markdown
작성 일자 : 2026-01-06
```

## 기획
어쩌다가 일을 맡게 되었다.
무수히 많은 사이트를 들어가서 화면 캡쳐를 하고, 이 URL에 이 화면이 나온다는 것을 PPT로 만들어야 한다.

꾸미는 것은 둘째치고 n00개 되는 양을 매번 캡쳐, PPT로 이동 하는 것은 쉽지 않은 일이다.

그래서 컴팩트하게 자동화하여 진행하고자 한다.

목표는 크게 3가지 이다.
- url은 csv 양식으로 입력 받음. index와 함께 편리한 입력
- 캡쳐된 이미지는 index이름으로 저장.
- PPT에 화면과 함께 저장되며 상단에 url 텍스트 박스로 입력.

INPUT
- 사용자가 캡쳐해야하는 무수히 많은 URL CSV 파일
OUTPUT
- 지정된 경로에 캡쳐본 저장
- 캡쳐본을 통해 PPT로 제작
- (들어가지 못하는 사이트일 경우 누락된 URL 따로 보관) 
## 설계
### 필요 기술

#### Playwrite
- Selenium과 굉장히 비슷한 친구.
- Chromium / Firefox / WebKit을 제어하는 브라우저 자동화 도구, JS 렌더링 페이지 캡쳐에 안정적
- Headless 실행, Full-page 스크린 샷, 네트워크 대기 등 웹 자동화에 필요한 기능을 기본 제공함

#### python-pptx
- Python에서 PPTX 파일을 생성, 편집하기 위한 라이브러리
- 슬라이드 추가, 텍스트 박스, 이미지 삽입, 레이아웃 제어 등을 코드로 제어 가능함

### 구현 순서
1. CSV 양식 만들기
	1. 테스트 데이터셋 만들기 (5개 정도)
2. playwright로 스크린샷 저장되는 것 구현
	1. 캡쳐본 이름을 index로 저장하기 구현
3. python-pptx 도입해서 PPT화 하기

## 구현 완료
```
uv add playwright pandas python-pptx pillow
uv run playwright install chromium
```
Template
![[Pasted image 20260106222113.png]]
idx에 인덱스를 입력하고 url을 우측에 입력하게 둔다.

Result
![[Pasted image 20260106221900.png]]
실행 날짜 기준으로 폴더가 생긴다.
현재는 example로 5개의 url을 진행하였다.

![[Pasted image 20260106221938.png]]
양식에 맞게 넣은 url 들 캡쳐본이 index이름으로 저장되고 가장 마지막에 result.pptx가 생성된다.

![[Pasted image 20260106222009.png]]
이렇게 간단하게 PPT 빈 화면에 캡쳐본과 url 만 두었다.
세부적인건 추후 수정 예정!

만약 실패한다면 빈 화면에 실패 URL이 입력되며 실패한 URL만 따로 모아 CSV가 생성된다.


---
## 시행착오
- 페이지 전체 로드 안됨.
	- time out 기점을 1000으로 생성하니 특정 웹페이지가 제대로 로드 되기 전에 캡쳐하여 어그러지는 경우가 있었다.
	- 그래서 time out 기점을 3000으로 늘렸다.

- n00개 진행할 시 느린 속도
	- 기본적인 반복문으로 진행하니 timeout 페이지가 걸릴 경우 너무 오랜 시간이 소요되었다.
	- 그래서 비동기 방식 병렬 처리를 진행하였으며 실패한 케이스는 별도로 모아서 관리하기로 하였다.

- PPT 이미지 삽입
	- 세로가 긴 이미지라면 PPT 양식에 의해 화면을 억지로 늘려서 넣었었다.
	- 가독성이 좋지 않아 세로를 중점으로 이미지를 맞추고 추후에 가로 이미지를 관리하기로 수정하였다.
### 한계점과 개선점
- 애플, 네이버와 같은 대규모 웹페이지 전체 로드 안됨.
	- 일부 페이지는 렌더링 방식때문에 그럴 수도 있다고함.
	- 사용자의 스크롤에 따라 움직이는 페이지여서 그런 경우 있음.
	- 하지만 내가 필요한 페이지는 대부분 정적인 페이지일 것이기 때문에 괜찮을 것으로 예상됨

- 전체 페이지를 캡쳐해야하는가? 에 대한 의문이 생김
	- 만약 전체 페이지가 아닌 보이는 페이지 캡쳐만 원한다면 viewport 캡쳐를 진행하면 될 것 같음.

